<!--Separate events into upcoming and past based on date-->
{% assign today = site.time | date: "%Y-%m-%d" %}
{% assign upcoming_events = "" | split: "" %}
{% assign past_events = "" | split: "" %}

{% for event in include.events %}
  {% assign event_date_parts = event.date | split: "/" %}
  {% assign event_date = event_date_parts[2] | append: "-" | append: event_date_parts[0] | append: "-" | append: event_date_parts[1] %}
  {% if event_date >= today %}
    {% assign upcoming_events = upcoming_events | push: event %}
  {% else %}
    {% assign past_events = past_events | push: event %}
  {% endif %}
{% endfor %}

<!--Display Upcoming Events-->
{% if upcoming_events.size > 0 %}
<div class="event-section-label">Upcoming</div>
{% assign upcoming_events_sorted = upcoming_events | sort: "date" %}
{% for event in upcoming_events_sorted %}
<div class="event-entry">
  <div class="event-date">
    <span class="event-month">{{event.month}}</span>
    <span class="event-day">{{event.day}}</span>
    <span class="event-weekday">{{event.weekday}}</span>
  </div>
  <div class="event-body">
    <div class="event-meta">{% if event.time %}{{event.time}}{% endif %}{% if event.time and event.place %} · {% endif %}{% if event.place %}{{event.place}}{% endif %}</div>
    {% if event.person %}<div class="event-speaker">{{event.person}}{% if event.affiliation %}, {{event.affiliation}}{% endif %}</div>{% endif %}
    <h2 class="event-title">{% if event.url %}<a href="{{event.url}}">{{event.title}}</a>{% else %}{{event.title}}{% endif %}</h2>
    {% if event.abstract %}<div class="event-abstract">{{event.abstract | markdownify}}</div>{% endif %}
    {% if event.paper-links %}{% for paper in event.paper-links %}<div class="event-download"><a href="{{paper[1]}}">{{paper[0]}}</a></div>{% endfor %}{% endif %}
  </div>
</div>
{% endfor %}
{% endif %}

<!--Display Past Events-->
{% if past_events.size > 0 %}
<div class="event-section-label" style="margin-top: 3rem;">Past</div>
{% assign past_events_sorted = past_events | sort: "date" | reverse %}
{% for event in past_events_sorted %}
<div class="event-entry event-past">
  <div class="event-date">
    <span class="event-month">{{event.month}}</span>
    <span class="event-day">{{event.day}}</span>
    <span class="event-weekday">{{event.weekday}}</span>
  </div>
  <div class="event-body">
    <div class="event-meta">{% if event.time %}{{event.time}}{% endif %}{% if event.time and event.place %} · {% endif %}{% if event.place %}{{event.place}}{% endif %}</div>
    {% if event.person %}<div class="event-speaker">{{event.person}}{% if event.affiliation %}, {{event.affiliation}}{% endif %}</div>{% endif %}
    <h2 class="event-title">{{event.title}}</h2>
    {% if event.abstract %}<div class="event-abstract">{{event.abstract | markdownify}}</div>{% endif %}
  </div>
</div>
{% endfor %}
{% endif %}
